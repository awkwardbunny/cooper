%!PS-Adobe-3.0
%%Creator: groff version 1.19.1
%%CreationDate: Wed Sep 30 23:21:58 2015
%%DocumentNeededResources: font Times-Roman
%%+ font Times-Bold
%%+ font Courier
%%+ font Times-Italic
%%DocumentSuppliedResources: file pipe.eps
%%+ procset grops 1.19 1
%%Pages: 14
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.19 1
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Bold
%%IncludeResource: font Courier
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Courier@0 ENC0/Courier RE
/Times-Bold@0 ENC0/Times-Bold RE/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)69.336 60 Q
(Unit 4/pg 1)55.998 E(\2512015 Jef)126.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Bold@0 SF(Signals)247.465 120 Q/F2 13/Times-Roman@0 SF
-.52(Wi)33.336 156 S 2.203
(thin the UNIX virtual computer \(process\) model, signals serv).52 F
5.452(ear)-.195 G 2.202(ole analogous to)-5.452 F .626
(interrupts in a ph)33.336 171 R .626(ysical computer)-.065 F 7.126(.T)
-.715 G(he)-7.126 E 3.876(y\()-.195 G .626(can\) cause e)-3.876 F -.195
(xe)-.195 G .626(cution of the user).195 F .627(-mode program)-.26 F
1.987(to be interrupted and transfer to a pre-established handler)33.336
186 R 5.237(,j)-.52 G 1.987(ust lik)-5.237 F 5.236(ev)-.13 G 1.986
(ectored hardw)-5.431 F(are)-.13 E 3.25(interrupts. The)33.336 201 R
3.25(yc)-.195 G(an also be mask)-3.25 E(ed and unmask)-.13 E(ed.)-.13 E
(Lik)33.336 231 Q 5.149(eh)-.13 G(ardw)-5.149 E 1.899
(are interrupts, signals can be said to be)-.13 F F1(synchr)5.149 E
(onous)-.234 E F2(or)5.149 E F1(asynchr)5.149 E(onous)-.234 E F2 5.15
(,i)C(f,)-5.15 E(respecti)33.336 246 Q -.195(ve)-.325 G(ly).195 E 6.631
(,t)-.845 G 3.381
(he cause of the signal can or can not be associated with a particular)
-6.631 F 3.666(instruction or operation that the process is currently e)
33.336 261 R -.195(xe)-.195 G 6.916(cuting. An).195 F -.195(ex)6.916 G
3.666(ample of an).195 F 1.729(asynchronous signal w)33.336 276 R 1.729
(ould be an interacti)-.13 F 2.119 -.195(ve u)-.325 H 1.729(ser deli)
.195 F -.195(ve)-.325 G 1.729(ring SIGINT to the process by).195 F .657
(pressing Control-C on the terminal.)33.336 291 R .657(An e)7.157 F .657
(xample of a synchronous signal is a SIGSEGV)-.195 F(deli)33.336 306 Q
-.195(ve)-.325 G(red to the process when it attempts an ille).195 E
-.065(ga)-.195 G 3.25(lm).065 G(emory access.)-3.25 E 2.112
(As we shall see in a later unit, signals may be vie)33.336 327 R 2.112
(wed as taking place in tw)-.325 F 5.362(os)-.13 G(tages:)-5.362 E F1
(sending)33.336 342 Q F2(\(aka)4.741 E F1(generating)4.741 E F2(or)4.741
E F1(posting)4.741 E F2 4.741(\)as)C 1.491(ignal, and then)-4.741 F F1
(deli)4.741 E -.13(ve)-.13 G(ry).13 E F2 4.741(,i)C 4.742(.e. the)-4.741
F 1.492(action in the)4.742 F .122(recipient process which results.)
33.336 357 R .122(Signals may be sent e)6.622 F .121
(xplicitly by one user process to one)-.195 F .52
(or more processes \(including itself\) via the)33.336 372 R/F3 13
/Courier@0 SF(kill)3.77 E F2 .52(system call.)3.77 F .52(The k)7.02 F
.52(ernel may also send)-.13 F(dif)33.336 387 Q .672
(ferent signals to a process as a result of errors or e)-.325 F -.195
(ve)-.325 G .672(nts, e.g \(by no means a complete).195 F(list\):)33.336
402 Q 3.25<8349>33.336 417 S(lle)-3.25 E -.065(ga)-.195 G 3.25(lm).065 G
(emory access: SIGSEGV or SIGB)-3.25 E(US \(sync\))-.13 E 3.25<8349>
33.336 432 S(lle)-3.25 E -.065(ga)-.195 G 3.25(li).065 G
(nstruction opcode: SIGILL)-3.25 E(\(sync\))35.365 E 3.25<8348>33.336
447 S(angup on controlling terminal session: SIGHUP)-3.25 E(\(async\))
29.092 E 3.25<834b>33.336 462 S -.195(ey)-3.575 G
(board interrupt from controlling terminal: SIGINT).195 E(\(async\))
4.366 E 3.25<8341>33.336 477 S(synchronous I/O noti\214cation: SIGIO)
-3.25 E(\(async\))16.32 E 3.25<8344>33.336 492 S
(eath of a child: SIGCHLD)-3.25 E(\(async\))33.412 E F1
(kill system call)226.529 522 Q F2 5.283(Ap)33.336 558 S 2.033
(rocess can send an)-5.283 F 5.283(yo)-.195 G 2.034
(ther process, including itself, an)-5.283 F 5.284(ys)-.195 G 2.034
(ignal by using the)-5.284 F F3(kill)5.284 E F2(system call:)33.336 573
Q/F4 10/Courier@0 SF(kill\(pid,sig\))33.336 585 Q F2 2.089
(The user id of the killer must match the recipient, i.e. you can')
33.336 606 R 5.338(tw)-.234 G 2.088(illy-nilly kill other)-5.338 F 3.273
(folks' processes.)33.336 621 R(Ho)9.773 E(we)-.325 E -.195(ve)-.325 G
4.313 -.52(r, t).195 H 3.273(he super).52 F 3.274
(-user \(uid==0\) may send an)-.26 F 6.524(yp)-.195 G 3.274
(rocess a signal.)-6.524 F(Special v)33.336 636 Q(alues can be used for)
-.325 E F3(pid)3.25 E F2(to do nifty things:)3.25 E 3.25<8370>33.336 651
S(id==0: Send to all processes in the process group \(to be co)-3.25 E
-.195(ve)-.195 G(red in another unit\)).195 E 3.25<8370>33.336 666 S
(id== -1: Kill all processes with user id equal to killer)-3.25 E(.)
-.715 E 3.25<8370>33.336 681 S
(id== -n: \(n!=1\) Kill all processes in process group n.)-3.25 E 5.015
(A0v)33.336 702 S 1.765(alue for)-5.34 F F3(sig)5.015 E F2(doesn')5.015
E 5.015(ta)-.234 G 1.765(ctually send the signal, b)-5.015 F 1.764
(ut checks whether it w)-.26 F 1.764(ould ha)-.13 F -.195(ve)-.26 G
(been possible to do so.)33.336 717 Q(It can be used to probe the e)6.5
E(xistence of a process.)-.195 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 2)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Bold@0 SF(Pr)132.37 120 Q
(e-de\214ned UNIX signal numbers and beha)-.234 E(viors)-.325 E/F2 13
/Times-Roman@0 SF 3.858(UNIX de\214nes dozens of signals, some system-d\
ependent, which represent dif)33.336 150 R(ferent)-.325 E 13.019
(conditions. Symbolic)33.336 165 R 9.769(names, such as)13.019 F/F3 13
/Courier@0 SF(SIGHUP)13.019 E F2 13.019(,a)C 9.768
(re found by #includ'ing)-13.019 F F3(<sys/signal.h>)33.336 180 Q F2
9.03(.T)C 2.53(he assignment of signal numbers is k)-9.03 F 5.781
(ernel-speci\214c. Although)-.13 F 2.889
(certain signal numbers such as 1, 2, 3, 9 and 15 are unlik)33.336 195 R
2.889(ely e)-.13 F -.195(ve)-.325 G 6.139(rt).195 G 6.139(oc)-6.139 G
2.889(hange, good)-6.139 F .212
(programmatic practice is to use the symbolic names at all times.)33.336
210 R .212(Here are signals de\214ned)6.712 F(under Linux k)33.336 225 Q
(ernel 3.16, x86 architecture:)-.13 E/F4 10/Courier@0 SF 27.6(Sig# Name)
33.336 237 R(Def Act)91.2 E(Desc)73.2 E 51.6(1S)33.336 249 S 73.2
(IGHUP Terminate)-51.6 F(Hangup on controlling tty)3.6 E 51.6(2S)33.336
261 S 73.2(IGINT Terminate)-51.6 F(Keyboard interrupt)3.6 E 51.6(3S)
33.336 273 S 67.2(IGQUIT Coredump)-51.6 F(Keyboard abort)9.6 E 51.6(4S)
33.336 285 S 73.2(IGILL Coredump)-51.6 F(Illegal Instruction)9.6 E 51.6
(5S)33.336 297 S 67.2(IGTRAP Coredump)-51.6 F(Tracing/breakpoint trap)
9.6 E 51.6(6S)33.336 309 S 67.2(IGABRT Coredump)-51.6 F
(Abort \(raised by abort\(3\)\))9.6 E 51.6(7S)33.336 321 S 73.2
(IGBUS Coredump)-51.6 F(Bus Error \(bad memory access\))9.6 E 51.6(8S)
33.336 333 S 73.2(IGFPE Coredump)-51.6 F(Floating Point/Math Exception)
9.6 E 51.6(9S)33.336 345 S 67.2(IGKILL Terminate)-51.6 F
(Non-blockable kill)3.6 E 39.6(10 SIGUSR1)33.336 357 R -2.4
(Terminate User)73.2 F(definable)6 E 39.6(11 SIGSEGV)33.336 369 R 3.6
(Coredump Segmentation)73.2 F(Violation \(non-exist addr\))6 E 39.6
(12 SIGUSR2)33.336 381 R -2.4(Terminate User)73.2 F(definable)6 E 39.6
(13 SIGPIPE)33.336 393 R -2.4(Terminate Write)73.2 F(to a broken pipe)6
E 39.6(14 SIGALRM)33.336 405 R -2.4(Terminate Alarm)73.2 F
(clock \(see alarm\(2\)\))6 E 39.6(15 SIGTERM)33.336 417 R -2.4
(Terminate Normal)73.2 F(terminate request)6 E 39.6(16 SIGSTKFLT)33.336
429 R -2.4(Terminate Co-processor)61.2 F(stack fault \(UNUSED\))6 E 39.6
(17 SIGCHLD)33.336 441 R 15.6(Ignore Child)73.2 F(exit/status change)6 E
39.6(18 SIGCONT)33.336 453 R 15.6(Resume Continue)73.2 F
(stopped process)6 E 39.6(19 SIGSTOP)33.336 465 R 27.6(Stop Stop)73.2 F
(process \(unblockable\))6 E 39.6(20 SIGTSTP)33.336 477 R 27.6
(Stop Keyboard)73.2 F(stop)6 E 39.6(21 SIGTTIN)33.336 489 R 27.6
(Stop Stopped)73.2 F(waiting for tty input)6 E 39.6(22 SIGTTOU)33.336
501 R 27.6(Stop Stopped)73.2 F(waiting for tty output)6 E 39.6
(23 SIGURG)33.336 513 R 15.6(Ignore Urgent)79.2 F(data on socket)6 E
39.6(24 SIGXCPU)33.336 525 R 3.6(Coredump Exceeded)73.2 F
(CPU time limit)6 E 39.6(25 SIGXFSZ)33.336 537 R 3.6(Coredump Exceeded)
73.2 F(file size limit)6 E 39.6(26 SIGVTALRM)33.336 549 R -2.4
(Terminate Virtual)61.2 F(alarm clock \(see setitimer\(2\)\))6 E 39.6
(27 SIGPROF)33.336 561 R -2.4(Terminate Profiling)73.2 F(timer)6 E 39.6
(28 SIGWINCH)33.336 573 R 15.6(Ignore Tty)67.2 F(window size change)6 E
39.6(29 SIGIO)33.336 585 R -2.4(Terminate Signal-driven)85.2 F
(I/O \(aka SIGPOLL\))6 E 39.6(30 SIGPWR)33.336 597 R 15.6(Ignore Power)
79.2 F(going down)6 E 39.6(31 SIGSYS)33.336 609 R 3.6(Coredump Bad)79.2
F(system call #)6 E F2 2.08 -1.04(To l)33.336 639 T
(earn more about signals on your Linux platform,)1.04 E F1(man 7 signal)
3.25 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 3)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Bold@0 SF -.26(Pe)175.354 120 S
(nding signals and signal masks).26 E/F2 13/Times-Roman@0 SF 2.104
(The k)33.336 156 R 2.104(ernel maintains tw)-.13 F 5.354(ob)-.13 G
2.103(it\214elds concerning signals for each process.)-5.354 F
(Conceptually)8.603 E(,)-.845 E .23
(these are arrays of boolean \(1-bit\) v)33.336 171 R 3.48(alues. There)
-.325 F .23(is an element of this array for each v)3.48 F(alid)-.325 E
.988(signal number \(signal 0 is ne)33.336 186 R -.195(ve)-.325 G 4.238
(rav).195 G .988(alid signal, so this array conceptually starts at inde)
-4.563 F(x)-.195 E 4.842(1\). The)33.336 201 R/F3 13/Times-Italic@0 SF
1.593(pending signals)4.843 F F2 1.593
(array is set when a particular signal is posted to that process.)4.843
F 1.184(Note that since this is a boolean array)33.336 216 R 4.434(,n)
-.845 G 1.184(ot an inte)-4.434 F 1.184(ger array)-.195 F 4.434(,t)-.845
G 1.184(he k)-4.434 F 1.183(ernel does not "count")-.13 F F3 3.097
(how many)33.336 231 R F2 3.098(pending signals there are of a gi)6.347
F -.195(ve)-.325 G 6.348(ns).195 G 3.098(ignal number)-6.348 F 6.348(,j)
-.52 G 3.098(ust the presence or)-6.348 F(absence of such.)33.336 246 Q
.033(The other such \(conceptual\) array represents the)33.336 267 R F3
.032(signal mask)3.283 F F2 3.282(,o)C 3.282(rt)-3.282 G .032
(he list of signal numbers)-3.282 F 2.413(which are currently block)
33.336 282 R 5.663(ed. When)-.13 F 5.664(as)5.663 G 2.414
(ignal is posted to a process b)-5.664 F 2.414(ut that signal is)-.26 F
2.424(currently mask)33.336 297 R 2.424(ed \(block)-.13 F 2.424
(ed\), the signal is not for)-.13 F 5.673(gotten. The)-.234 F 2.423
(corresponding bit in the)5.673 F 1.931(pending signals \214eld is set.)
33.336 312 R 1.931(The signal is not deli)8.431 F -.195(ve)-.325 G 1.931
(red when it is block).195 F 1.932(ed, b)-.13 F 1.932(ut at the)-.26 F
.511(instant that the signal number is un-block)33.336 327 R .511
(ed, that signal will be deli)-.13 F -.195(ve)-.325 G .51
(red if pending.).195 F -1.04(We)7.01 G
(will discuss the mechanisms for changing the signal mask shortly)33.336
342 Q(.)-.845 E F1(Signal deli)182.4 372 Q -.13(ve)-.13 G
(ry and disposition).13 E F2 .755
(It is indeterminate when the signal is deli)33.336 408 R -.195(ve)-.325
G .756(red to the process, other than to say that it is).195 F 1.522
(some time after the signal has been sent.)33.336 423 R 1.522
(In the case of signals resulting from process)8.022 F -.13(fa)33.336
438 S .584(ults, such as bad memory accesses, the signal is deli).13 F
-.195(ve)-.325 G .584(red immediately and the process).195 F .289
(does not continue to e)33.336 453 R -.195(xe)-.195 G .289(cute the f)
.195 F .289(aulting instruction.)-.13 F(Block)6.789 E .289
(ed signals are not deli)-.13 F -.195(ve)-.325 G .289(red at).195 F
1.778(all while the signal is still block)33.336 468 R 1.778
(ed, and then are deli)-.13 F -.195(ve)-.325 G 1.779
(red at some indeterminate time).195 F(after the signal becomes unblock)
33.336 483 Q(ed.)-.13 E .8(Upon signal deli)33.336 504 R -.195(ve)-.325
G(ry).195 E 4.05(,t)-.845 G .799
(he pending signal bit for that signal number is cleared.)-4.05 F .799
(There are)7.299 F(se)33.336 519 Q -.195(ve)-.325 G 4.019
(ral basic outcomes or "dispositions".).195 F 4.019
(As we will see shortly)10.519 F 7.269(,t)-.845 G 4.02(he process can)
-7.269 F(establish the desired outcomes on a per)33.336 534 Q
(-signal-number basis.)-.26 E<83>33.336 549 Q F1 -1.196(Te)3.56 G .31
(rminate the pr)1.196 F(ocess.)-.234 E F2 .31
(In some cases \(determined by signal number)6.81 F 3.56(,s)-.52 G .31
(ee table abo)-3.56 F -.195(ve)-.195 G(\),).195 E(a)33.336 564 Q F1(cor)
3.373 E(edump)-.234 E F2 .123(\214le is generated, which is a \214le co\
ntaining the contents of memory)3.373 F 6.623(.T)-.845 G .124
(his \214le)-6.623 F 1.247(is named)33.336 579 R/F4 13/Courier@0 SF
(core)4.497 E F2 1.247(and is created in the current w)4.497 F 1.246
(orking directory of the process, as if the)-.13 F .7(process itself ha\
d opened this \214le for creation/writing and wrote the contents of mem\
ory)33.336 594 R 2.24(to it.)33.336 609 R 2.239
(If the process does not ha)8.739 F 2.629 -.195(ve p)-.26 H 2.239
(ermission to create this \214le, it is not created.).195 F(A)8.739 E
.572(resource limit \(see the)33.336 624 R F4(ulimit)3.822 E F2 .572
(command or the)3.822 F F4(setrlimit)3.822 E F2 .572
(system call\) can be set to)3.822 F .951
(limit the maximum size of the core \214le.)33.336 639 R .95
(The core dump \214le contains the contents of all)7.451 F(rele)33.336
654 Q -.325(va)-.325 G 3.524(nt memory sections \("core" is an old term\
 for main memory\) at the time of).325 F 2.176
(termination, as well as the re)33.336 669 R 5.425(gisters. This)-.195 F
(allo)5.425 E 2.175(ws a deb)-.325 F 2.175
(ugger \(such as gdb or adb\) to)-.26 F .314
(reconstruct the call stack and the contents of all local and global v)
33.336 684 R .314(ariables, and determine)-.325 F .729
(where in the code the of)33.336 699 R .729(fense occured.)-.325 F .729
(The format of the core dump \214le is architecture-)7.229 F
(speci\214c.)33.336 714 Q<83>33.336 729 Q F1(Ignor)3.25 E(e)-.234 E F2
(the signal entirely)3.25 E 6.5(.C)-.845 G
(ertain signals \(SIGKILL and SIGST)-6.5 E(OP\) can')-.234 E 3.25(tb)
-.234 G 3.25(ei)-3.25 G(gnored.)-3.25 E<83>33.336 744 Q F1(Stop)3.611 E
F2 .361(the process.)3.611 F .361(This is used in conjunction with)6.861
F F1 .362(job contr)3.612 F(ol)-.234 E F2 3.612(,w)C .362(hich allo)
-3.612 F .362(ws a running)-.325 F 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 4)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF 3.68(process or processes, attached to a user')
33.336 120 R 6.93(st)-.715 G 3.68
(erminal session, to be frozen, unfrozen,)-6.93 F 3.922
(detached or re-attached to that terminal.)33.336 135 R 3.922
(Stopping the process is not the same as)10.422 F 2.184(terminating it.)
33.336 150 R 2.184(Stop is the def)8.684 F 2.184
(ault action for certain signal numbers \(see table abo)-.13 F -.195(ve)
-.195 G(\)).195 E(which the k)33.336 165 Q
(ernel has assigned for job control.)-.13 E<83>33.336 180 Q/F2 13
/Times-Bold@0 SF(Resume)4.109 E F1 .859(the process, if stopped.)4.109 F
.86(This is the def)7.36 F .86(ault action for)-.13 F/F3 13/Courier@0 SF
(SIGCONT)4.11 E F1 4.11(,w)C .86(hich is the)-4.11 F
(only signal which can produce this action.)33.336 195 Q<83>33.336 210 Q
F2(Handle)3.25 E F1(the signal with a speci\214ed user)3.25 E(-le)-.26 E
-.195(ve)-.325 G 3.25(lf).195 G(unction call as detailed belo)-3.25 E
-.845(w.)-.325 G F2(Establishing signal disposition)183.525 240 Q F1
(Classically)33.336 276 Q 9.402(,t)-.845 G(he)-9.402 E F3(signal)9.402 E
F1 6.152(system call pro)9.402 F 6.151
(vides the means for controlling signal)-.195 F
(disposition, although it can not block or unblock signals.)33.336 291 Q
/F4 10/Courier@0 SF
(void \(*signal\(int signum, void \(*handler\)\(int\)\)\)\(int\);)33.336
303 Q F1 .498
(This rather complicated prototype indicates that, for the signal)33.336
318 R F3(signum)3.749 E F1 3.749(,t)C .499(he handler will)-3.749 F .764
(be set to the function)33.336 333 R F3(handler)4.013 E F1(.)A F3
(signal)7.263 E F1 .763(will return the pre)4.013 F .763(vious v)-.325 F
.763(alue of the handler)-.325 F(,)-.52 E .607(which can be stashed a)
33.336 348 R -.13(wa)-.195 G 3.857(yi).13 G 3.857(fi)-3.857 G 3.857(ti)
-3.857 G 3.857(sd)-3.857 G .607(esired to restore it later)-3.857 F
7.107(.O)-.715 G 3.857(nf)-7.107 G(ailure,)-3.987 E F3(signal)3.857 E F1
(returns)3.857 E(the v)33.336 363 Q(alue)-.325 E F3(SIG_ERR)3.25 E F1(.)
A(In addition to a bona-\214de signal handler function address,)33.336
384 Q F3(handler)3.25 E F1(can be:)3.25 E 3.25<8353>33.336 399 S
(IG_IGN: Ignore the signal or)-3.25 E 3.25<8353>33.336 414 S
(IG_DFL: Reset to the def)-3.25 E(ault handling for this signal, as gi)
-.13 E -.195(ve)-.325 G 3.25(ni).195 G 3.25(nt)-3.25 G(he table abo)
-3.25 E -.195(ve)-.195 G(.).195 E(These are numbers chosen so that the)
33.336 444 Q 3.25(yc)-.195 G(an')-3.25 E 3.25(tp)-.234 G
(ossibly be the v)-3.25 E(alid address of a function.)-.325 E F2
(The signal handler)215.323 474 Q F1 4.117(As)33.336 510 S .867
(ignal handler is an ordinary function.)-4.117 F .866
(When a signal is deli)7.366 F -.195(ve)-.325 G .866
(red and the disposition).195 F .216(of that signal number is to in)
33.336 525 R -.26(vo)-.52 G .476 -.13(ke a h).26 H(andler).13 E 3.466
(,i)-.52 G 3.466(ta)-3.466 G .217
(ppears as if the handler function had been)-3.466 F 1.527
(called from the instruction within the program that w)33.336 540 R
1.527(as e)-.13 F -.195(xe)-.195 G 1.527(cuting when the signal w).195 F
(as)-.13 E(deli)33.336 555 Q -.195(ve)-.325 G 4.334(red. This).195 F
1.084
(is analogous to an interrupt service routine in responding to a hardw)
4.334 F(are)-.13 E(interrupt.)33.336 570 Q 1.172
(The signal handler function is called with a single inte)33.336 591 R
1.172(ger parameter)-.195 F 4.422(,t)-.52 G 1.172(he signal number)
-4.422 F 2.5(that is being handled \(using the)33.336 606 R F3
(sigaction)5.751 E F1(interf)5.751 E 2.501
(ace, additional parameters can be)-.13 F 6.519(passed. This)33.336 621
R 3.269(is be)6.519 F 3.269(yond the scope of this unit\).)-.195 F 3.268
(The same handler function can be)9.768 F(speci\214ed for multiple sign\
als and this parameter can be used to disambiguate.)33.336 636 Q .691
(In most v)33.336 657 R .691(ersions of UNIX, including Linux, the def)
-.195 F .692(ault beha)-.13 F .692(vior is that when signal)-.26 F/F5 13
/Times-Italic@0 SF(n)3.942 E F1(is)3.942 E(deli)33.336 672 Q -.195(ve)
-.325 G 1.367(red to a process and handled,).195 F F5(n)4.617 E F1 1.367
(is temporarily added to the block)4.617 F 1.366(ed signals mask)-.13 F
1.414(upon entry to the handler)33.336 687 R 4.664(,a)-.52 G 4.665(tt)
-4.664 G 1.415(he same time that the pending signal bit for)-4.665 F F5
(n)4.665 E F1 1.415(is cleared.)4.665 F 1.987(This pre)33.336 702 R
-.195(ve)-.325 G 1.987
(nts the signal handler from being called re-entrantly).195 F 8.487(.U)
-.845 G 1.986(pon return from the)-8.487 F(handler)33.336 717 Q 4.199
(,t)-.52 G .95(he original block)-4.199 F .95
(ed signal mask is restored.)-.13 F .95(If the signal)7.45 F F5(n)4.2 E
F1 -.13(wa)4.2 G 4.2(sr).13 G(ecei)-4.2 E -.195(ve)-.325 G 4.2(dw).195 G
(hile)-4.2 E .801(the handler')33.336 732 R 4.051(sw)-.715 G .801(as e)
-4.181 F -.195(xe)-.195 G .801
(cuting, then the handler will be immediately re-in).195 F -.26(vo)-.52
G -.13(ke).26 G 4.051(d\().13 G -.26(bu)-4.051 G 4.051(tt).26 G .801
(his is)-4.051 F 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 5)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF(not re-entrant\).)33.336 120 Q .849
(The signal handler function has a return type of v)33.336 141 R 4.1
(oid. When)-.26 F .85(the signal handler function)4.1 F 1.011
(returns, e)33.336 156 R -.195(xe)-.195 G 1.011
(cution resumes at the point of interruption.).195 F -.195(Fo)7.51 G
4.26(rc).195 G 1.01(ertain synchronous signals,)-4.26 F .125
(such as SIGILL, this may result in the same in)33.336 171 R -.325(va)
-.52 G .126(lid operation being repeated endlessly).325 F 3.376(,o)-.845
G(r)-3.376 E 2.814(other unde\214ned results.)33.336 186 R(Or)9.314 E
6.064(,t)-.52 G 2.814(he signal handler may ha)-6.064 F 3.204 -.195
(ve t)-.26 H(ak).195 E 2.814(en action to correct the)-.13 F 6.611
(problem. The)33.336 201 R 3.361(signal handler can also e)6.611 F 3.362
(xit the program, possibly taking cleanup or)-.195 F(reco)33.336 216 Q
-.195(ve)-.195 G(ry action.).195 E -1.3(Ye)6.5 G 3.25(tat)1.3 G
(hird commonly seen approach is the long jump:)-3.25 E/F2 13
/Times-Bold@0 SF(setjmp/longjmp)223.643 246 Q F1 2.258
(Consider a command-line mathematical program.)33.336 282 R 2.257
(The main loop e)8.758 F -.195(xe)-.195 G 2.257(cutes commands).195 F
.752(through a function)33.336 297 R/F3 13/Courier@0 SF(do_command)4.003
E F1 7.253(.E)C -.195(ve)-7.253 G(ntually).195 E 4.003(,o)-.845 G .753
(ne of these commands leads, via a long)-4.003 F
(chain of function calls, to:)33.336 312 Q/F4 10/Courier@0 SF
(long_compute\(\))33.336 324 Q({)33.336 336 Q
(/* a very long calculation */)90.936 348 Q(})33.336 360 Q F1 2.815
(At some point during)33.336 381 R F3(long_compute\(\))6.065 E F1 6.065
(,t)C 2.814(he user gets impatient and hits ^C.)-6.065 F -1.04(We)9.314
G -.13(wo)33.336 396 S(uldn').13 E 3.401(tw)-.234 G .151
(ant to abort the entire program and potentially lose unsa)-3.531 F
-.195(ve)-.26 G 3.402(dd).195 G 3.402(ata. W)-3.402 F(e')-1.04 E 3.402
(dl)-.65 G(ik)-3.402 E 3.402(et)-.13 G(o)-3.402 E 2.042
(return to the command prompt.)33.336 411 R 4.122 -1.04(We w)8.542 H
2.042(ould also lik).91 F 5.292(et)-.13 G 5.292(oa)-5.292 G -.26(vo)
-5.552 G 2.042(id cluttering the code with).26 F 3.093
(frequent checks of some sort of global "abort" \215ag.)33.336 426 R
(Thankfully)9.593 E 6.343(,Ch)-.845 G 3.093(as a user)-6.343 F(-le)-.26
E -.195(ve)-.325 G(l).195 E(mechanism kno)33.336 441 Q
(wn as "setjmp/longjmp".)-.325 E(Another name for this is)6.5 E F2
(non-local goto)3.25 E F1(.)A F4(#include <setjmp.h>)33.336 468 Q
(jmp_buf int_jb;)33.336 492 Q
(/*typedef'd in setjmp.h, really a char[] */)82.8 E
(void int_handler\(int sn\))33.336 516 Q({)33.336 528 Q 1.2
(longjmp\(int_jb,1\); /*)90.936 540 R
(No need for & since it is an array */)6 E(})33.336 552 Q(main\(\))
33.336 576 Q({)33.336 588 Q(char cmdbuf[BUFSIZ];)39.336 600 Q
(\(void\)signal\(SIGINT,int_handler\);)90.936 612 Q(for\(;;\))90.936 624
Q({)90.936 636 Q(printf\("Command> "\);)148.536 648 Q
(if \(!fgets\(cmdbuf,sizeof cmdbuf,stdin\)\) break;)148.536 660 Q
(if \(sigsetjmp\(int_jb,1\)!=0\))148.536 672 Q({)148.536 684 Q
(printf\("\\nInterrupted\\n"\);)206.136 696 Q(continue;)206.136 708 Q(})
148.536 720 Q(do_command\(cmdbuf\);)148.536 732 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 6)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 10/Courier@0 SF(})90.936 117 Q(})33.336 129 Q/F2 13/Courier@0 SF
(setjmp)33.336 150 Q/F3 13/Times-Roman@0 SF 3.549(,f)C .299
(rom the program')-3.549 F 3.549(ss)-.715 G .299
(tandpoint, appears to be a function that is called once, and)-3.549 F
2.29(returns one or more times.)33.336 165 R F2(setjmp)8.79 E F3 2.29
(stores conte)5.54 F 2.29(xt information, such as the program)-.195 F
(counter)33.336 180 Q 6.919(,s)-.52 G 3.668(tack pointer and re)-6.919 F
3.668(gister contents, into the)-.195 F F2(jmp_buf)6.918 E F3 6.918(,w)C
3.668(hich is simply a)-6.918 F F2(typedef)33.336 195 Q F3 .41
(for an array of a suf)3.66 F .411
(\214cient size to hold this information.)-.325 F .411
(The program counter)6.911 F 2.721
(location stored is the address of the instruction follo)33.336 210 R
2.721(wing the call to setjmp.)-.325 F(setjmp)9.221 E
(returns 0 when it is called \(for the \214rst time.\))33.336 225 Q 5.45
(Ac)33.336 246 S 2.2(all to)-5.45 F F2(longjmp)5.45 E F3 2.2
(uses the conte)5.45 F 2.2(xt information stored in the supplied)-.195 F
F2(jmp_buf)5.45 E F3(to)5.45 E 2.258
(return control to the setjmp point.)33.336 261 R 2.258(The second ar)
8.758 F 2.258(gument will be the percei)-.234 F -.195(ve)-.325 G 5.508
(dr).195 G(eturn)-5.508 E -.325(va)33.336 276 S 1.904(lue from setjmp.)
.325 F 1.904(It can not be 0, and if 0 is supplied the ar)8.404 F 1.905
(gument will silently be)-.234 F .778(changed to 1.)33.336 291 R F2
(longjmp)7.278 E F3 .778(restores all of the sa)4.028 F -.195(ve)-.26 G
4.027(dr).195 G -.195(eg)-4.027 G .777(ister v).195 F .777(alues, e)
-.325 F .777(xcept the one used to)-.195 F(indicate the return v)33.336
306 Q(alue from a function, which it sets to the supplied v)-.325 E
(alue.)-.325 E .204(The jump b)33.336 327 R(uf)-.26 E .205(fer must be \
visible both to setjmp and to longjmp, which means it must be a)-.325 F
1.419(global v)33.336 342 R 1.419(ariable, not a local v)-.325 F 4.669
(ariable. Because)-.325 F 1.419
(longjmp rolls back the stack frame to its)4.669 F 1.46
(state when setjmp w)33.336 357 R 1.46
(as called, longjmp must be called from a function descended from)-.13 F
1.056(the one in which setjmp w)33.336 372 R 1.056(as called.)-.13 F
1.056(Otherwise, the stack frame may ha)7.556 F 1.445 -.195(ve a)-.26 H
1.055(lready been).195 F -.195(ove)33.336 387 S(rwritten by other funct\
ion calls and sheer terror and chaos will reign.).195 E .005(In ef)
33.336 408 R .005(fect, longjmp pro)-.325 F .005(vides the ability to)
-.195 F F2(goto)3.256 E F3 .006(across function boundaries.)3.256 F .006
(As is the case)6.506 F(with)33.336 423 Q F2(goto)3.547 E F3(,)A F2
(setjmp/longjmp)3.547 E F3 .296(is not an e)3.547 F .296(vil thing.)
-.325 F .296(Frequently it is the cleanest w)6.796 F .296(ay to)-.13 F
(bail out of deep code.)33.336 438 Q .237
(Note that setjmp/longjmp are entirely a user)33.336 459 R(-le)-.26 E
-.195(ve)-.325 G 3.487(lm).195 G 3.487(echanism. The)-3.487 F 3.487(ya)
-.195 G .238(re not system calls.)-3.487 F .72
(When a signal handler tak)33.336 480 R .72
(es a longjmp, the restoration of the block)-.13 F .719
(ed signals mask does)-.13 F 2.089(not tak)33.336 495 R 5.339(ep)-.13 G
5.339(lace. By)-5.339 F(using)5.339 E F2(sigsetjmp)5.339 E F3 2.089
(instead, the signal mask is stored in the jump)5.339 F -.26(bu)33.336
510 S -.325(ff).26 G(er).325 E 3.417(,a)-.52 G .167
(nd is restored during longjmp.)-3.417 F -.52(Wi)6.666 G .166
(thout this, the code abo).52 F .556 -.195(ve w)-.195 H .166
(ould only w).065 F .166(ork the)-.13 F(\214rst time the SIGINT w)33.336
525 Q(as recei)-.13 E -.195(ve)-.325 G 3.25(d. After).195 F
(that, SIGINT w)3.25 E(ould continue to be mask)-.13 E(ed.)-.13 E/F4 13
/Times-Bold@0 SF(Masking/Blocking signals)196.356 555 Q F3 5.923 -1.04
(We w)33.336 591 T 3.843(ill no)1.04 F 7.093(we)-.325 G 3.843(xplore ho)
-7.288 F 7.094(wt)-.325 G 7.094(om)-7.094 G 3.844
(anipulate the process')-7.094 F 7.094(sb)-.715 G(lock)-7.094 E 3.844
(ed signals mask.)-.13 F(The)10.344 E 1.865
(block/unblock mechanism is most useful in protecting)33.336 606 R F4
1.865(critical r)5.115 F(egions)-.234 E F3 1.865(of code, where)5.115 F
.886(data structures are in an inconsistent state.)33.336 621 R -.195
(Fo)7.386 G 4.136(re).195 G .886
(xample, consider a routine to transfer a)-4.331 F
(balance between accounts:)33.336 636 Q F1(transfer_balance\(a,b,n\))
33.336 648 Q(struct account *a,*b;)33.336 660 Q({)33.336 672 Q
(a->balance-=n;)90.936 684 Q(b->balance+=n;)90.936 696 Q(})33.336 708 Q
F3(Ev)33.336 723 Q(ery 24 hours, we w)-.195 E
(ant to prepare a summary report:)-.13 E F1(main\(\))33.336 735 Q 0 Cg
EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 7)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 10/Courier@0 SF({)33.336 117 Q(/*...*/)90.936 129 Q
(signal\(SIGALRM,alarm_handler\);)90.936 141 Q(set_alarm\(\);)90.936 153
Q(/*...*/)90.936 165 Q(})33.336 177 Q(alarm_handler\(\))33.336 201 Q({)
33.336 213 Q(struct account *p;)39.336 225 Q
(signal\(SIGALARM,alarm_handler\);)90.936 237 Q
(for \(p=first_account;p;p=p->next\))90.936 249 Q(printf\("Account %s)
148.536 261 Q(Balance %d0,a->name,a->balance\);)18 E(set_alarm\(\);)
90.936 273 Q(})33.336 285 Q(set_alarm\(\))33.336 309 Q({)33.336 321 Q
(alarm\(24*3600\);)90.936 333 Q(})33.336 345 Q/F2 13/Times-Roman@0 SF
2.7(This uses the)33.336 366 R/F3 13/Courier@0 SF(alarm)5.95 E F2 2.7
(system call to set an alarm which, at the speci\214ed number of)5.95 F
(seconds in the future, will cause deli)33.336 381 Q -.195(ve)-.325 G
(ry of SIGALRM to the process.).195 E 2.528
(Consider what happens when the alarm signal arri)33.336 402 R -.195(ve)
-.325 G 5.779(sb).195 G 2.529(etween the tw)-5.779 F 5.779(os)-.13 G
2.529(tatements of)-5.779 F F3(transfer_balance)33.336 417 Q F2 7.732
(.T)C 1.231
(he data structure is in an inconsistent state and the summary)-7.732 F
.91(report is incorrect.)33.336 432 R 2.99 -1.04(We w)7.41 H .91(ill e)
1.04 F .91(xamine these issues of concurrenc)-.195 F 4.16(ya)-.195 G .91
(nd synchronization in)-4.16 F 2.037(greater detail in Unit 7.)33.336
447 R -.195(Fo)8.537 G 5.287(rn).195 G -.325(ow)-5.287 G 5.287(,t)-.52 G
2.036(he best \214x is to block the alarm signal during the)-5.287 F
(critical re)33.336 462 Q(gion:)-.195 E F1(transfer_balance\(a,b,n\))
33.336 474 Q(struct account *a,*b;)33.336 486 Q({)33.336 498 Q
(sigset_t set;)39.336 510 Q(sigemptyset\(&set\);)90.936 522 Q
(sigaddset\(&set,SIGALRM\);)90.936 534 Q
(sigprocmask\(SIG_BLOCK,&set,NULL\);)90.936 546 Q(a->balance-=n;)90.936
558 Q(b->balance+=n;)90.936 570 Q(sigprocmask\(SIG_UNBLOCK,&set,NULL\);)
90.936 582 Q(})33.336 594 Q F2 5.676(Each process has a bit \214eld whi\
ch represents which signals are block)33.336 615 R 8.926(ed. The)-.13 F
F3(sigprocmask)33.336 630 Q F2 1.987
(system call can be used to set bits in that mask, remo)5.238 F 2.377
-.195(ve b)-.195 H 1.987(its, set the).195 F 3.75
(entire mask at once, or query the current v)33.336 645 R 3.751
(alue of the mask.)-.325 F 3.751(It uses a data type)10.251 F F3
(sigset_t)33.336 660 Q F2 .763(to abstract the issue of ho)4.013 F 4.013
(wm)-.325 G(an)-4.013 E 4.013(yb)-.195 G .763(its are in that v)-4.013 F
(ector)-.195 E 4.013(,a)-.52 G .763(nd what data type)-4.013 F 1.029
(has enough bits to hold it.)33.336 675 R -.195(Fo)7.529 G 4.279(re).195
G 1.029(xample, on the Linux k)-4.474 F 1.03
(ernel, where there are 64 signal)-.13 F .566(numbers and when running \
on an architecture with 32 bit ints, it is de\214ned in the system)
33.336 690 R(header \214les as:)33.336 705 Q F1(typedef struct {)33.336
717 Q(unsigned long sig[_NSIG_WORDS];)81.336 729 Q
(//this works out to [2])111.6 E 6(}s)33.336 741 S(igset_t;)-6 E 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 8)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF 1.012(If the SIGALRM signal arri)33.336 120 R
-.195(ve)-.325 G 4.262(sw).195 G 1.012(hile it is block)-4.262 F 1.013
(ed, it will stay in the pending signal set)-.13 F 1.662
(until the second)33.336 135 R/F2 13/Courier@0 SF(sigprocmask)4.912 E F1
1.662(system call remo)4.912 F -.195(ve)-.195 G 4.912(st).195 G 1.661
(he mask.)-4.912 F 1.661(Shortly thereafter the)8.161 F
(signal will be deli)33.336 150 Q -.195(ve)-.325 G
(red and the handler will be in).195 E -.26(vo)-.52 G -.13(ke).26 G(d.)
.13 E/F3 13/Times-Bold@0 SF(The sigaction interface)204.149 186 Q F1
.572(In the early years of UNIX, there were some inconsistencies in ho)
33.336 222 R 3.822(wt)-.325 G .572(he signal\(2\) system)-3.822 F 2.76
(call functioned, in particular some UNIX v)33.336 237 R 2.759
(ersions reset the signal disposition of the)-.195 F 1.187
(signal in question upon entry to the handler)33.336 252 R 7.688(.B)
-.715 G 1.188(ecause of the potential confusion, a ne)-7.688 F(w)-.325 E
1.896(system call w)33.336 267 R 1.896(as introduced among all UNIX v)
-.13 F 1.896(ariants in the 1990s.)-.325 F(The)8.395 E F2(sigaction)
5.145 E F1 .705(system call uses a more complicated interf)33.336 282 R
.705(ace, b)-.13 F .706(ut can accomplish a lot more in a single)-.26 F
(call.)33.336 297 Q/F4 10/Courier@0 SF(int sigaction\(int sig,const str\
uct sigaction *act, struct sigaction *oldact\))33.336 309 Q
(struct sigaction {)33.336 333 Q 27.6(void \(*sa_handler\)\(int\);)
90.936 357 R(sigset_t sa_mask;)90.936 369 Q 33.6(int sa_flags;)90.936
381 R(/* Some more stuff...pretty complicated, read man page */)90.936
393 Q(};)33.336 405 Q F1 1.674(As with)33.336 426 R F2(signal)4.924 E F1
(,)A F2(sa_handler)4.924 E F1 1.673
(can be set to SIG_DFL to reset to def)4.924 F 1.673(ault action, or)
-.13 F .538(SIG_IGN to ignore the signal, or the address of the signal \
handler function.)33.336 441 R F2(sa_flags)7.038 E F1
(is a bitwise \215ags w)33.336 456 Q
(ord that speci\214es a potpourri of options, including:)-.13 E 7.706
<8353>33.336 471 S 7.705(A_RESETHAND: Restore)-7.706 F 4.455
(signal action to def)7.705 F 4.455(ault when entering handler)-.13 F
7.705(,a)-.52 G(ka)-7.705 E(unreliable signal semantics.)33.336 486 Q
8.647<8353>33.336 501 S 5.398
(A_NODEFER: Do not automatically block signal while being handled.)
-8.647 F(Aka)11.898 E(SA_NOMASK)33.336 516 Q 5.688<8353>33.336 531 S
2.438(A_SIGINFO: Call the signal handler with 3 ar)-5.688 F 5.688
(guments. The)-.234 F 2.438(\214rst ar)5.688 F 2.438(gument is the)-.234
F .87(signal number)33.336 546 R 7.37(.T)-.715 G .87
(he second is a pointer to a)-7.37 F F2(siginfo_t)4.12 E F1 .87
(structure which contains a lot)4.12 F .468(of useful \(and potentially\
 architecture-speci\214c\) information about the cause of the signal.)
33.336 561 R .233(The third ar)33.336 576 R .233
(gument is a pointer to a)-.234 F F2(ucontext_t)3.483 E F1 .233
(structure which represents the conte)3.483 F(xt)-.195 E .665
(at the point in the program at which the signal w)33.336 591 R .665
(as recei)-.13 F -.195(ve)-.325 G 3.914(d. This).195 F(ar)3.914 E .664
(gument is primarily)-.234 F(for use in multi-threaded programs.)33.336
606 Q 3.885<8353>33.336 621 S(A_REST)-3.885 E(AR)-1.209 E 1.936 -.65
(T: I)-.78 H .636(ncreases the lik).65 F .636
(elihood that system calls interrupted by this signal and)-.13 F
(handled will restart when the handler returns.)33.336 636 Q
(See discussion belo)6.5 E -.845(w.)-.325 G(Mak)33.336 666 Q 3.606(es)
-.13 G .356(ure to set sa_\215ags=0 if you don')-3.606 F 3.605(tw)-.234
G .355(ant an)-3.735 F 3.605<798d>-.195 G 3.605(ags. Otherwise)-3.605 F
.355(the \214eld may contain)3.605 F(random g)33.336 681 Q
(arbage that will be mis-interpreted as v)-.065 E
(arious SA_XXX \215ags!)-.325 E F2(sa_mask)33.336 702 Q F1 .963
(describes which signals to block upon entry to the handler)4.212 F
4.213(,i)-.52 G 4.213(na)-4.213 G .963(ddition to the)-4.213 F 1.231
(signal being handled itself, which is block)33.336 717 R 1.23
(ed unless SA_NODEFER has been speci\214ed.)-.13 F 5.529
(Be sure to set this correctly with)33.336 732 R F2(sigemptyset)8.779 E
F1(,)A F2(sigaddset)8.779 E F1 8.779(,e)C 5.529(tc. otherwise)-8.779 F 0
Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 9)73.998 E(\2512015 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF -.195(ex)33.336 120 S
(traneous signals may be mask).195 E(ed during your handler')-.13 E 3.25
(si)-.715 G -2.47 -.52(nv o)-3.25 H(cation.).52 E/F2 13/Times-Bold@0 SF
(Real-time signals)219.853 150 Q F1 1.169
(Signals were originally concei)33.336 186 R -.195(ve)-.325 G 4.419(da)
.195 G 4.419(saw)-4.419 G 1.169
(ay to terminate or control processes, hence the)-4.549 F .554
(rather se)33.336 201 R -.195(ve)-.325 G .554(re name).195 F/F3 13
/Courier@0 SF(kill)3.804 E F1 .554
(for the system call to send a signal.)3.804 F .554(Signals ha)7.054 F
.944 -.195(ve b)-.26 H .555(een used as).195 F 3.444(ap)33.336 216 S
(rimiti)-3.444 E .584 -.195(ve i)-.325 H(nter).195 E .194
(-process communications \(IPC\) mechanism, e.g. a daemon process which)
-.26 F 3.772
(responds to a SIGHUP and re-reads its con\214guration \214les.)33.336
231 R(Ho)10.272 E(we)-.325 E -.195(ve)-.325 G 4.812 -.52(r, t).195 H
3.773(he f).52 F 3.773(act that)-.13 F .237(traditional signals don')
33.336 246 R 3.487(tq)-.234 G .237
(ueue and carry no additional data mak)-3.487 F .236
(es them of limited use for)-.13 F 3.454(IPC. In)33.336 261 R 3.454(al)
3.454 G .204(ater unit, we will see better w)-3.454 F .204
(ays for processes to send messages to each other)-.13 F(.)-.715 E 1.881
(On some more modern v)33.336 282 R 1.881(ersions of UNIX,)-.195 F F2
-.234(re)5.131 G(al-time).234 E F1 1.88(signals are supported.)5.131 F
1.88(These are)8.38 F(numbered)33.336 297 Q F3(SIGRTMIN)6.133 E F1(to)
6.133 E F3(SIGRTMAX)6.133 E F1 2.883(and ha)6.133 F 3.273 -.195(ve n)
-.26 H 6.134(op).195 G 2.884(re-de\214ned meanings.)-6.134 F 2.884
(Under the)9.384 F .359(current Linux k)33.336 312 R .359
(ernel, signals 32 through 63 are real-time signals.)-.13 F(Ho)6.858 E
(we)-.325 E -.195(ve)-.325 G 3.608(rs).195 G .358(ignals 32-34)-3.608 F
2.091(are used by the threads library)33.336 327 R 5.341(,a)-.845 G
2.091(nd should thus be a)-5.341 F -.26(vo)-.26 G 2.091
(ided by other code.).26 F(Therefore)8.592 E(SIGR)33.336 342 Q .042
(TMIN is de\214ned as 35.)-.78 F -1.43(Yo)6.542 G .042(ur mileage may v)
1.43 F(ary)-.325 E 3.292(,s)-.845 G 3.291(oa)-3.292 G -.13(lwa)-3.291 G
.041(ys use the macros and a).13 F -.26(vo)-.26 G(id).26 E
(hard-coded signal numbers.)33.336 357 Q(Unlik)33.336 378 Q 3.961(es)
-.13 G .711(tandard signals, real-time signals queue.)-3.961 F .711
(If a process is sent, e.g.)7.211 F 3.962(5i)7.212 G .712(nstances of)
-3.962 F 2.28(signal #35 while that signal is being block)33.336 393 R
2.279(ed, upon un-blocking the signal, it will be)-.13 F(deli)33.336 408
Q -.195(ve)-.325 G .199(red to the process 5 separate times.).195 F .199
(Furthermore, the real time signals are deli)6.699 F -.195(ve)-.325 G
(red).195 E(in the order in which the)33.336 423 Q 3.25(yw)-.195 G
(ere sent.)-3.25 E(The)33.336 453 Q F3(sigqueue)4.899 E F1 1.649
(system call is similar to)4.899 F F3(kill)4.898 E F1 4.898(,b)C 1.648
(ut allo)-5.158 F 1.648(ws the sender of the signal to)-.325 F
(attach a small, opaque chunk of data:)33.336 468 Q/F4 10/Courier@0 SF
(int sigqueue\(pid_t pid, int sig, union sigval value\))33.336 480 Q
(union sigval {)33.336 504 Q(int sival_int;)90.936 516 Q
(void *sival_ptr;)90.936 528 Q(})33.336 540 Q F1 2.036
(The union will be the lar)33.336 555 R 2.037
(ger of the int size or the pointer size for that machine.)-.234 F(The)
8.537 E .964(contents are passed along to the signal handler by the k)
33.336 570 R .963(ernel and are opaque \(the k)-.13 F(ernel)-.13 E .883
(does not interpret the union v)33.336 585 R(alue\).)-.325 E F3
(sigqueue)7.383 E F1 .883(could also be used to send a traditional)4.133
F .171(signal \(signal number)33.336 600 R 3.421(<3)6.671 G .171(2\), b)
-3.421 F .171(ut such a signal still w)-.26 F(on')-.13 E 3.42(tq)-.234 G
3.42(ueue. The)-3.42 F .17(opaque data will be)3.42 F(deli)33.336 615 Q
-.195(ve)-.325 G 1.345(red, b).195 F 1.345(ut if multiple instances of \
the traditional \(not real-time\) signal occur)-.26 F 4.596(,n)-.52 G
-.325(ew)-4.596 G(er).325 E(instances will o)33.336 630 Q -.195(ve)-.195
G(rwrite the earlier data.).195 E F2(Interrupted System Calls)197.285
660 Q F1 1.478(Certain system calls are designated as "long" calls.)
33.336 696 R(Generally)7.978 E 4.728(,t)-.845 G 1.478
(hese are calls that may)-4.728 F .545
(block for an inde\214nite period of time, for e)33.336 711 R .545
(xample, reading from the terminal or netw)-.195 F(ork)-.13 E 6.2
(connection. When)33.336 726 R 2.95(an asynchronous signal arri)6.2 F
-.195(ve)-.325 G 6.2(sw).195 G 2.95(hile the process is block)-6.2 F
2.95(ed in a)-.13 F .831
("long" system call \(of course a synchronous signal can not arri)33.336
741 R 1.221 -.195(ve d)-.325 H .831(uring this point since).195 F 0 Cg
EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 10)71.748 E(\2512015 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF .418(the process is not e)33.336 120 R
-.195(xe)-.195 G .418(cuting instructions\), and that signal is handled\
 with a signal handler).195 F 1.372
(function, the system call is said to ha)33.336 135 R 1.762 -.195(ve b)
-.26 H 1.372(een interrupted.).195 F 1.372(Assuming the signal handler)
7.872 F 1.294(returns \(it doesn')33.336 150 R 4.543(tl)-.234 G 1.293
(ongjmp out or e)-4.543 F 1.293
(xit the process\), the system call will return a f)-.195 F(ailure)-.13
E(with errno set to EINTR \(Interrupted System Call\).)33.336 165 Q
2.124(Often, this is e)33.336 186 R 2.124(xactly what one w)-.195 F
5.374(ants. Ho)-.13 F(we)-.325 E -.195(ve)-.325 G 3.164 -.52(r, i).195 H
5.374(fi).52 G 5.374(ti)-5.374 G 5.374(sn)-5.374 G 2.124
(ecessary to mak)-5.374 F 5.375(et)-.13 G 2.125(he signal)-5.375 F 3.704
(handling perfectly transparent, the system call must be "restarted" wh\
en the signal)33.336 201 R 1.108(handler returns and the process must g\
o back to sleep until the system call \214nishes.)33.336 216 R -1.04(To)
7.608 G(specify that beha)33.336 231 Q(vior)-.26 E 3.25(,u)-.52 G
(se the SA_REST)-3.25 E(AR)-1.209 E 3.25<548d>-.78 G(ag with)-3.25 E/F2
13/Courier@0 SF(sigaction)3.25 E F1(.)A .726(System calls which support\
 being restarted must be speci\214cally coded to do so.)33.336 252 R
.726(When a)7.226 F 4.158(system call is restarted after a signal, e)
33.336 267 R -.195(xe)-.195 G 4.158(cution has gone from k).195 F 4.158
(ernel mode \(the)-.13 F 2.659(interrupted system call\), to the user)
33.336 282 R 2.659(-mode signal handler)-.26 F 5.909(,a)-.52 G 2.659
(nd then back in to k)-5.909 F(ernel)-.13 E 2.671
(mode, restoring the interrupted conte)33.336 297 R 2.671
(xt of the system call \(e.g. ho)-.195 F 5.921(wm)-.325 G(an)-5.921 E
5.921(yb)-.195 G 2.671(ytes had)-5.921 F(already been written\).)33.336
312 Q .603(The Linux k)33.336 333 R .603(ernel is some)-.13 F .603
(what inconsistent about restarting system calls.)-.325 F .602
(Certain system)7.102 F 3.022(calls al)33.336 348 R -.13(wa)-.13 G 3.022
(ys restart, re).13 F -.065(ga)-.195 G 3.022(rdless of the SA_REST).065
F(AR)-1.209 E 6.273(Tp)-.78 G 6.273(reference. Certain)-6.273 F 3.023
(calls ne)6.273 F -.195(ve)-.325 G(r).195 E 1.233(restart and thus al)
33.336 363 R -.13(wa)-.13 G 1.233(ys gi).13 F 1.623 -.195(ve E)-.325 H
1.233(INTR when interrupted, and certain calls pay attention to).195 F
2.335(the SA_REST)33.336 378 R(AR)-1.209 E 5.585(Tp)-.78 G 5.585
(reference. Note)-5.585 F 2.335(that the SA_REST)5.585 F(AR)-1.209 E
5.585(Tp)-.78 G 2.336(reference \215ag is of)-5.585 F 5.586(fb)-.325 G
(y)-5.586 E(def)33.336 393 Q(ault for all signals.)-.13 E/F3 13
/Times-Bold@0 SF(SIGCHLD)237.358 423 Q F1(The)33.336 453 Q F2(SIGCHLD)
3.844 E F1 .594(signal is some)3.844 F .594(what special.)-.325 F .594
(By def)7.094 F .594(ault, whene)-.13 F -.195(ve)-.325 G 3.843(rap).195
G .593(rocess terminates, a)-3.843 F F2(SIGCHLD)33.336 468 Q F1 .083
(signal is sent to its parent.)3.333 F .083(The def)6.583 F .083
(ault disposition \(SIG_DFL\) of)-.13 F F2(SIGCHLD)3.333 E F1(is)3.333 E
.999(to ignore the signal, b)33.336 483 R .999
(ut this is not quite the same thing as e)-.26 F .998
(xplicitly ignoring the signal)-.195 F(with)33.336 498 Q F2(sigaction)
7.024 E F1(or)7.024 E F2(signal)7.024 E F1 10.275(.T)C 3.775
(he distinction has to do with compatability with)-10.275 F(dif)33.336
513 Q 4.137(ferent v)-.325 F 4.136
(arieties of UNIX, some of which \(including Linux\) maintain that when)
-.325 F F2(SIGCHLD)33.336 528 Q F1 .379(is e)3.629 F .38
(xplicitly ignored \(disposition is set to SIG_IGN\), it tells the k)
-.195 F .38(ernel that the)-.13 F(parent has no interest in the child, \
and thus a zombie will not be created.)33.336 543 Q F3
(Signal interactions with f)162.595 573 Q(ork and exec)-.325 E F1
(During a successful)33.336 603 Q F2(exec)3.25 E F1(system call:)3.25 E
5.016<8354>33.336 618 S 1.766(he k)-5.016 F 1.766
(ernel clears the set of pending signals.)-.13 F 1.765(The set of block)
8.265 F 1.765(ed signals remains the)-.13 F(same.)33.336 633 Q 3.52
<8341>33.336 648 S .66 -.195(ny s)-3.52 H .271
(ignals which were set to go to a signal handler are changed to).195 F
F2(SIG_IGN)3.521 E F1 3.521(,b)C(ecause)-3.521 E(in the ne)33.336 663 Q
3.25(we)-.325 G -.195(xe)-3.445 G
(cutable, the address of the signal handler\(s\) w).195 E(ould ob)-.13 E
(viously be in)-.195 E -.325(va)-.52 G(lid.).325 E 5.864<8349>33.336 678
S 5.864(ft)-5.864 G 2.614(he SIGCHLD signal w)-5.864 F 2.614(as being e)
-.13 F 2.614(xplicitly ignored, its disposition is reset to the)-.195 F
(def)33.336 693 Q(ault \(which is to implicitly ignore it\).)-.13 E .949
(After a)33.336 723 R F2(fork)4.199 E F1 4.199(,t)C .95(he set of pendi\
ng signals for the child process is initialized to be empty)-4.199 F(.)
-.845 E .78(The parent is not af)33.336 738 R 4.03(fected. The)-.325 F
.78(signal disposition in the child and set of block)4.03 F .78
(ed signals)-.13 F 0 Cg EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 11)71.748 E(\2512015 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF(is e)33.336 120 Q
(xactly the same as the parent.)-.195 E/F2 13/Times-Bold@0 SF(Pipes)
252.529 150 Q F1 3.239(The UNIX)33.336 186 R F2(pipe)6.489 E F1(pro)
6.489 E 3.24
(vides the fundamental means of interprocess communication, in)-.195 F
2.902(accordance with the UNIX philosoph)33.336 201 R 6.151(yo)-.065 G
6.151(fp)-6.151 G(ro)-6.151 E 2.901(viding small, \215e)-.195 F 2.901
(xible tools that can be)-.195 F(combined to b)33.336 216 Q(uild up lar)
-.26 E(ger solutions.)-.234 E 3.25(Ap)33.336 237 S
(ipe is a uni-directional FIFO.)-3.25 E(It is created with the)6.5 E/F3
13/Courier@0 SF(pipe)3.25 E F1(system call:)3.25 E/F4 10/Courier@0 SF
(main\(\))33.336 249 Q({)33.336 261 Q(int fds[2];)39.336 273 Q
(if \(pipe\(fds\)<0\))90.936 285 Q({)90.936 297 Q
(perror\("can't create pipe"\);)148.536 309 Q(return -1;)148.536 321 Q
(})90.936 333 Q F1 -1.3 -1.04(Tw o)33.336 354 T(ne)6.241 E 5.201<778c>
-.325 G 1.951
(le descriptor numbers are allocated and returned via the tw)-5.201 F
1.952(o-element array)-.13 F F3(fds)33.336 369 Q F1(.)A F3(fds[0])6.5 E
F1(is the read side of the pipe,)3.25 E F3(fds[1])3.25 E F1
(is the write side.)3.25 E 2.404(Although a pipe is accessed lik)33.336
390 R 5.654(ea)-.13 G 2.403
(\214le, using \214le descriptors, there is no path in the)-.001 F .589
(\214lesystem which refers to the pipe.)33.336 405 R .589
(This means that processes which communicate via a)7.089 F .214(pipe mu\
st be descended from a common process which created the pipe and passed\
 along)33.336 420 R .679
(the \214le descriptors via the I/O redirection methods co)33.336 435 R
-.195(ve)-.195 G .68(red in Unit 3.).195 F .68(This is a common)7.18 F
1.077(application when spa)33.336 450 R 1.076
(wning a pipeline of commands from a UNIX shell, in which all of)-.195 F
.579(the command processes are descended from the same shell process.)
33.336 465 R .58(In subsequent units,)7.08 F 7.15(we will e)33.336 480 R
7.15(xplore other pipe-lik)-.195 F 10.4(em)-.13 G 7.15
(echanisms that allo)-10.4 F 10.4(wa)-.325 G 7.15(rbitrary processes to)
-10.4 F(communicate, including processes on dif)33.336 495 Q
(ferent host systems.)-.325 E F2(Pipe pr)225.027 516 Q(operties)-.234 E
F1 3.751<8354>33.336 546 S .501(he pipe is uni-directional.)-3.751 F
.502(An attempt to read from the write side, or write to the read)7.001
F 4.756(side, will be greeted with EB)33.336 561 R(ADF)-.455 E 11.256
(.O)-1.04 G 8.006(ns)-11.256 G 4.756
(ome systems \(e.g. Solaris\), the pipe is)-8.006 F(bidirectional, ho)
33.336 576 Q(we)-.325 E -.195(ve)-.325 G 1.04 -.52(r, t).195 H(his beha)
.52 E(vior should not be relied upon.)-.26 E 3.892<8354>33.336 591 S
.642(he pipe is a FIFO.)-3.892 F .642
(The order of the bytes written to the write side of the pipe will be)
7.142 F 3.145(strictly preserv)33.336 606 R 3.145
(ed when read from the read side.)-.195 F 3.145(Data will ne)9.645 F
-.195(ve)-.325 G 6.395(rb).195 G 6.395(el)-6.395 G 3.145
(ost, modi\214ed,)-6.395 F .659
(duplicated or transferred out of sequence.)33.336 621 R(Ho)7.159 E(we)
-.325 E -.195(ve)-.325 G 1.7 -.52(r, i).195 H 3.91(fm).52 G .66
(ultiple processes are attempting)-3.91 F
(to read from the same pipe, the distrib)33.336 636 Q
(ution of data to each will be unpredictable.)-.26 E 5.372<834d>33.336
651 S 2.122(essage boundaries are not preserv)-5.372 F 2.122
(ed by the pipe.)-.195 F 2.121(If one process performs, e.g., 4)8.622 F
.768(small writes to the pipe, and later a read is performed, all of th\
e data will be returned as)33.336 666 R .512(one lar)33.336 681 R .512
(ge chunk.)-.234 F .511(In order to perform record-oriented, as opposed\
 to stream-oriented I/O,)7.012 F .002(some sort of application-le)33.336
696 R -.195(ve)-.325 G 3.252(lr).195 G .002
(ecord marking protocol needs to be emplo)-3.252 F .003
(yed \(e.g. records)-.13 F(delimited with ne)33.336 711 Q(wlines\).)
-.325 E F2(Flo)230.507 726 Q 3.25(wC)-.13 G(ontr)-3.25 E(ol)-.234 E 0 Cg
EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 12)71.748 E(\2512015 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF 4.429<8357>33.336 120 S 1.178
(hen reading from a pipe, the)-4.429 F/F2 13/Courier@0 SF(read)4.428 E
F1 1.178(system call will block until there are some data)4.428 F -.26
(av)33.336 135 S 3.7(ailable. It)-.065 F .451(will then return an)3.701
F 3.701(ya)-.195 G .451(nd all a)-3.701 F -.325(va)-.26 G .451
(ilable data \(up to limit speci\214ed by the caller).325 F 1.846
(as the third ar)33.336 150 R 1.845(gument to read\), and will not w)
-.234 F 1.845(ait until an entire b)-.13 F(uf)-.26 E 1.845
(fer full of data are)-.325 F -.26(av)33.336 165 S 3.25(ailable. [W)
-.065 F 3.25(ea)-1.04 G(re ignoring non-blocking I/O options for no)
-3.25 E -.845(w.)-.325 G(]).845 E 5.285<8345>33.336 180 S 2.035
(ach pipe is a FIFO of a speci\214c capacity)-5.285 F 5.286(,w)-.845 G
2.036(hich is system-dependent and possibly)-5.286 F 3.808
(controllable by the system administrator)33.336 195 R 10.308(.A)-.715 G
3.808(typical FIFO size is 16K.)-3.25 F 3.808(If there is)10.308 F
(insuf)33.336 210 Q .409(\214cient room in the FIFO to handle the entir\
e write request, the write will block until)-.325 F 1.905
(there is room.)33.336 225 R 1.905(This pro)8.405 F 1.905
(vides the "back pressure" ag)-.195 F 1.905
(ainst the writing process to create)-.065 F("\215o)33.336 240 Q 4(wc)
-.325 G .75(ontrol" and throttle a f)-4 F .751
(ast writer piping to a slo)-.13 F 4.001(wr)-.325 G(eader)-4.001 E 7.251
(.\()-.715 G(Ag)-7.251 E .751(ain, we are ignoring)-.065 F .808
(non-blocking I/O options at this time.)33.336 255 R .808
(Non-blocking beha)7.308 F .808(vior can be speci\214ed for pipes)-.26 F
(using the)33.336 270 Q F2(fcntl)3.25 E F1(system call.)3.25 E
(This is be)6.5 E(yond the scope of this unit.\))-.195 E/F3 13
/Times-Bold@0 SF(Atomicity)239.899 285 Q F1 3.944<8349>33.336 315 S
3.944(ft)-3.944 G .694
(he write request size is 4K or less, the write will be handled)-3.944 F
F3(atomically)3.944 E F1 3.944(,a)C .694(nd, in the)-3.944 F -2.795
-.325(ev e)33.336 330 T .738(nt that there are multiple processes writi\
ng to the same pipe, these atomic writes will).325 F .013(be preserv)
33.336 345 R .013(ed and not interlea)-.195 F -.195(ve)-.26 G 3.263
(d. Ho).195 F(we)-.325 E -.195(ve)-.325 G 1.053 -.52(r, i).195 H 3.263
(ft).52 G .013(he write request size e)-3.263 F .013
(xceeds 4K, the write)-.195 F .691(will be brok)33.336 360 R .691
(en up into smaller chunks of 4K.)-.13 F .69
(In either case, the write blocks until it has)7.191 F .893
(completed entirely \(i.e.)33.336 375 R 4.143(aw)7.393 G .894
(rite system call of 65,536 bytes will not return until all 64K)-4.143 F
(ha)33.336 390 Q .39 -.195(ve m)-.26 H(ade it into the pipe\).).195 E
(writes to a pipe ne)6.5 E -.195(ve)-.325 G 3.25(rr).195 G
(eturn a "short" aka partial write.)-3.25 E F3(Connection Contr)212.385
405 Q(ol)-.234 E F1 4.381<8357>33.336 435 S 1.13(hen the write side of \
the pipe closes \(there are no more open \214le descriptors in an)-4.381
F(y)-.195 E .891
(processes referring to it\), this generates an EOF condition.)33.336
450 R .891(Once an)7.391 F 4.141(yp)-.195 G .891(ending data ha)-4.141 F
-.195(ve)-.26 G
(been read out of the FIFO, all subsequent reads will return 0.)33.336
465 Q 4.056<8357>33.336 480 S .806
(hen the read side of the pipe closes, this condition is kno)-4.056 F
.806(wn as a)-.325 F F3(br)4.056 E(ok)-.234 E .806(en pipe)-.13 F F1
7.306(.A)C -.195(ny)-7.306 G .689
(pending data in the FIFO are discarded.)33.336 495 R .689
(An attempt to write to a brok)7.189 F .689(en pipe will result)-.13 F
2.443(in the f)33.336 510 R 2.442
(ailure of the write system call with EPIPE.)-.13 F 5.692(As)8.942 G
2.442(ignal \(SIGPIPE\) will also be)-5.692 F(deli)33.336 525 Q -.195
(ve)-.325 G 3.472(red to the writer process.).195 F 3.472(The def)9.972
F 3.472(ault action of SIGPIPE is to terminate the)-.13 F 3.281
(process. This)33.336 540 R .03(ensures that a program which is poorly \
written and does not error check the)3.281 F F2(write)33.336 555 Q F1
(system call doesn')3.25 E 3.25(tc)-.234 G
(ontinue to try to push data into the brok)-3.25 E(en pipe fore)-.13 E
-.195(ve)-.325 G -.715(r.).195 G 6.339<8349>33.336 570 S 6.339(no)-6.339
G 3.089(rder to preserv)-6.339 F 6.339(et)-.195 G 3.089(his beha)-6.339
F 3.09(vior with respect to EOF and SIGPIPE/EPIPE, it is)-.26 F .487
(important to close an)33.336 585 R 3.737(ye)-.195 G .487
(xtraneous \214le descriptors that might be hanging on to the read or)
-3.932 F(write side of a pipe, especially during dups and forks.)33.336
600 Q 3.306<8341>33.336 615 S 3.306(ni)-3.306 G .057
(nteresting "feature" that occurs with brok)-3.306 F .057
(en pipes is that if the pipe is partially \214lled)-.13 F .643
(and then the reader side is closed, this will)33.336 630 R F3(not)3.892
E F1 .642(generate an error on)3.892 F F2(close)3.892 E F1 .642
(on the write)3.892 F 3.538(side. This)33.336 645 R -.13(wo)3.538 G .288
(uld appear to be a design \215a).13 F 1.978 -.845(w, i)-.195 H 3.539
(nt).845 G .289(hat data loss w)-3.539 F .289(ould be undetectable from)
-.13 F 1.708(the writing process')33.336 660 R 4.958(sv)-.715 G(ie)
-4.958 E 6.648 -.845(w. H)-.325 H -.325(ow).845 G -2.795 -.325(ev e).325
H 2.747 -.52(r, t).325 H 1.707
(he presumption is that a parent process in).52 F -.26(vo)-.52 G -.13
(ke).26 G(d).13 E .525
(both the reader and the writer and connected them with a pipeline.)
33.336 675 R .526(The abnormal e)7.025 F .526(xit of)-.195 F .213
(the reader process w)33.336 690 R .213
(ould be detected by the parent \(through the)-.13 F F2(wait)3.462 E F1
.212(system call\) which)3.462 F -.13(wo)33.336 705 S
(uld then report the f).13 E(ailure of the pipeline as a whole.)-.13 E
4.453<8354>33.336 720 S 1.203(he \214gure belo)-4.453 F 4.453(wi)-.325 G
1.204(llustrates a writer process \(ls\) connected to a reader process \
\(more\))-4.453 F(via a pipe.)33.336 735 Q 0 Cg EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 13)71.748 E(\2512015 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E 0 0 468 659 -347.982 490 33.336 467.982 PBEGIN
%%BeginDocument: pipe.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: pipe.fig
%%Creator: fig2dev Version 3.2 Patchlevel 4
%%CreationDate: Tue Feb 14 22:33:33 2012
%%For: hak@lex ()
%%BoundingBox: 0 0 659 490
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 490 moveto 0 0 lineto 659 0 lineto 659 490 lineto closepath clip newpath
-53.3 549.7 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/reencdict 12 dict def /ReEncode { reencdict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq
{ exch dup length array copy newfont 3 1 roll put }
{ exch newfont 3 1 roll put } ifelse } { pop pop } ifelse } forall
newfont /FontName newfontname put newcodesandnames aload pop
128 1 255 { newfont /Encoding get exch /.notdef put } for
newcodesandnames length 2 idiv { newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/isovec [
8#055 /minus 8#200 /grave 8#201 /acute 8#202 /circumflex 8#203 /tilde
8#204 /macron 8#205 /breve 8#206 /dotaccent 8#207 /dieresis
8#210 /ring 8#211 /cedilla 8#212 /hungarumlaut 8#213 /ogonek 8#214 /caron
8#220 /dotlessi 8#230 /oe 8#231 /OE
8#240 /space 8#241 /exclamdown 8#242 /cent 8#243 /sterling
8#244 /currency 8#245 /yen 8#246 /brokenbar 8#247 /section 8#250 /dieresis
8#251 /copyright 8#252 /ordfeminine 8#253 /guillemotleft 8#254 /logicalnot
8#255 /hyphen 8#256 /registered 8#257 /macron 8#260 /degree 8#261 /plusminus
8#262 /twosuperior 8#263 /threesuperior 8#264 /acute 8#265 /mu 8#266 /paragraph
8#267 /periodcentered 8#270 /cedilla 8#271 /onesuperior 8#272 /ordmasculine
8#273 /guillemotright 8#274 /onequarter 8#275 /onehalf
8#276 /threequarters 8#277 /questiondown 8#300 /Agrave 8#301 /Aacute
8#302 /Acircumflex 8#303 /Atilde 8#304 /Adieresis 8#305 /Aring
8#306 /AE 8#307 /Ccedilla 8#310 /Egrave 8#311 /Eacute
8#312 /Ecircumflex 8#313 /Edieresis 8#314 /Igrave 8#315 /Iacute
8#316 /Icircumflex 8#317 /Idieresis 8#320 /Eth 8#321 /Ntilde 8#322 /Ograve
8#323 /Oacute 8#324 /Ocircumflex 8#325 /Otilde 8#326 /Odieresis 8#327 /multiply
8#330 /Oslash 8#331 /Ugrave 8#332 /Uacute 8#333 /Ucircumflex
8#334 /Udieresis 8#335 /Yacute 8#336 /Thorn 8#337 /germandbls 8#340 /agrave
8#341 /aacute 8#342 /acircumflex 8#343 /atilde 8#344 /adieresis 8#345 /aring
8#346 /ae 8#347 /ccedilla 8#350 /egrave 8#351 /eacute
8#352 /ecircumflex 8#353 /edieresis 8#354 /igrave 8#355 /iacute
8#356 /icircumflex 8#357 /idieresis 8#360 /eth 8#361 /ntilde 8#362 /ograve
8#363 /oacute 8#364 /ocircumflex 8#365 /otilde 8#366 /odieresis 8#367 /divide
8#370 /oslash 8#371 /ugrave 8#372 /uacute 8#373 /ucircumflex
8#374 /udieresis 8#375 /yacute 8#376 /thorn 8#377 /ydieresis] def
/Times-Roman /Times-Roman-iso isovec ReEncode
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
0 slj 0 slc
 0.06000 0.06000 sc
%
% Fig objects follow
%
% 
% here starts figure with depth 50
% Arc
7.500 slw
gs  clippath
2024 6641 m 1998 6695 l 2135 6760 l 2040 6682 l 2161 6706 l cp
eoclip
 [60] 0 sd
n 6245.1 -1983.7 9632.4 54.4 116.0 arc
gs col0 s gr
 gr
 [] 0 sd
% arrowhead
n 2161 6706 m 2040 6682 l 2135 6760 l  col0 s
% Arc
gs  clippath
8997 5508 m 9028 5457 l 8899 5377 l 8986 5466 l 8868 5428 l cp
eoclip
 [60] 0 sd
n -6768.8 30678.8 29730.2 -74.0 -58.0 arc
gs col0 s gr
 gr
 [] 0 sd
% arrowhead
n 8868 5428 m 8986 5466 l 8899 5377 l  col0 s
% Polyline
n 900 6375 m 2025 6375 l 2025 9150 l 900 9150 l
 cp gs col0 s gr 
% Polyline
n 900 6675 m
 2025 6675 l gs col0 s gr 
% Polyline
n 900 6975 m
 2025 6975 l gs col0 s gr 
% Polyline
n 900 7275 m
 2025 7275 l gs col0 s gr 
% Polyline
n 900 7575 m
 2025 7575 l gs col0 s gr 
% Polyline
n 900 7875 m
 2025 7875 l gs col0 s gr 
% Polyline
n 900 8175 m
 2025 8175 l gs col0 s gr 
% Polyline
n 900 8475 m
 2025 8475 l gs col0 s gr 
% Polyline
n 900 8775 m
 2025 8775 l gs col0 s gr 
% Polyline
n 900 1650 m 2025 1650 l 2025 4425 l 900 4425 l
 cp gs col0 s gr 
% Polyline
n 900 1950 m
 2025 1950 l gs col0 s gr 
% Polyline
n 900 2250 m
 2025 2250 l gs col0 s gr 
% Polyline
n 900 2550 m
 2025 2550 l gs col0 s gr 
% Polyline
n 900 2850 m
 2025 2850 l gs col0 s gr 
% Polyline
n 900 3150 m
 2025 3150 l gs col0 s gr 
% Polyline
n 900 3450 m
 2025 3450 l gs col0 s gr 
% Polyline
n 900 3750 m
 2025 3750 l gs col0 s gr 
% Polyline
n 900 4050 m
 2025 4050 l gs col0 s gr 
% Polyline
n 4575 2250 m 7125 2250 l 7125 2700 l 4575 2700 l
 cp gs col0 s gr 
% Polyline
n 4575 4500 m 7125 4500 l 7125 4950 l 4575 4950 l
 cp gs col0 s gr 
% Polyline
gs  clippath
4435 2506 m 4444 2447 l 4294 2424 l 4409 2472 l 4285 2483 l cp
eoclip
n 1500 2025 m
 4425 2475 l gs col0 s gr gr

% arrowhead
n 4285 2483 m 4409 2472 l 4294 2424 l  col0 s
% Polyline
gs  clippath
4758 5179 m 4708 5145 l 4624 5272 l 4716 5189 l 4674 5305 l cp
eoclip
n 2025 6525 m 3975 6300 l
 4725 5175 l gs col0 s gr gr

% arrowhead
n 4674 5305 m 4716 5189 l 4624 5272 l  col0 s
% Polyline
n 8550 2325 m 11550 2325 l 11550 4200 l 8550 4200 l
 cp gs col0 s gr 
% Polyline
gs  clippath
8480 3108 m 8498 3050 l 8353 3005 l 8459 3070 l 8335 3062 l cp
eoclip
n 6825 2550 m
 8475 3075 l gs col0 s gr gr

% arrowhead
n 8335 3062 m 8459 3070 l 8353 3005 l  col0 s
% Polyline
gs  clippath
8356 3310 m 8314 3268 l 8206 3375 l 8313 3312 l 8249 3418 l cp
eoclip
n 6825 4800 m
 8325 3300 l gs col0 s gr gr

% arrowhead
n 8249 3418 m 8313 3312 l 8206 3375 l  col0 s
% Polyline
n 9075 5175 m 11850 5175 l 11850 6525 l 9075 6525 l
 cp gs col0 s gr 
% Polyline
gs  clippath
11415 5880 m 11415 5820 l 11263 5820 l 11383 5850 l 11263 5880 l cp
eoclip
n 9450 5850 m
 11400 5850 l gs col0 s gr gr

% arrowhead
n 11263 5880 m 11383 5850 l 11263 5820 l  col0 s
% Polyline
gs  clippath
11447 5119 m 11507 5109 l 11481 4960 l 11472 5084 l 11422 4970 l cp
eoclip
n 11250 3750 m
 11475 5100 l gs col0 s gr gr

% arrowhead
n 11422 4970 m 11472 5084 l 11481 4960 l  col0 s
/Times-Roman-iso ff 300.00 scf sf
975 5925 m
gs 1 -1 sc (file descriptor) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
975 6240 m
gs 1 -1 sc (table, more process) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
975 1200 m
gs 1 -1 sc (file descriptor) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
975 1515 m
gs 1 -1 sc (table, ls process) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
4725 1725 m
gs 1 -1 sc (struct file) col0 sh gr
/Times-Roman-iso ff 233.33 scf sf
4875 4800 m
gs 1 -1 sc (count=1  mode=R) col0 sh gr
/Times-Roman-iso ff 233.33 scf sf
4875 2550 m
gs 1 -1 sc (count=1  mode=W) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
8850 1500 m
gs 1 -1 sc (In-core inode) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
8850 1815 m
gs 1 -1 sc (for pipe) col0 sh gr
/Times-Roman-iso ff 233.33 scf sf
8700 2625 m
gs 1 -1 sc (Inode type=FIFO) col0 sh gr
/Times-Roman-iso ff 233.33 scf sf
8700 2880 m
gs 1 -1 sc (FS type=pipefs) col0 sh gr
/Times-Roman-iso ff 233.33 scf sf
8625 3225 m
gs 1 -1 sc (readers=1  writers=1) col0 sh gr
/Times-Roman-iso ff 300.00 scf sf
9675 4875 m
gs 1 -1 sc (FIFO buffer) col0 sh gr
% here ends figure;
$F2psEnd
rs
showpage
%%EndDocument
end PEND/F1 13/Times-Bold@0 SF(Named Pipes)231.046 518.982 Q/F2 13
/Times-Roman@0 SF 2.105(Pipes created with the)33.336 554.982 R/F3 13
/Courier@0 SF(pipe)5.354 E F2 2.104(system call do not ha)5.354 F 2.494
-.195(ve a)-.26 H 2.494 -.195(ny a).195 H 2.104
(ssociated pathname in the).195 F .002(\214lesystem namespace.)33.336
569.982 R .003(This means that the only access is through the \214le de\
scriptors; it is)6.502 F 4.196(not possible to use)33.336 584.982 R F3
(open)7.446 E F2 4.195(to g)7.445 F 4.195(ain access. Thus, the only w)
-.065 F 4.195(ay tw)-.13 F 7.445(op)-.13 G 4.195(rocesses can)-7.445 F
(communicate using a pipe is if the)33.336 599.982 Q 3.25(ys)-.195 G
(hare a common ancestor)-3.25 E(.)-.715 E(A)33.336 620.982 Q F1 2.068
(named pipe)5.318 F F2 2.068(is identical to a re)5.318 F 2.068
(gular pipe, b)-.195 F 2.069(ut it is accessed through a node in the)
-.26 F .598(\214lesystem ha)33.336 635.982 R .598(ving type)-.26 F F3
(S_IFIFO)3.848 E F2 7.098(.A)C .598
(named pipe is sometimes called a FIFO.)-3.25 F 2.678 -1.04(To c)7.098 H
(reate)1.04 E(this special node one can use the)33.336 650.982 Q F3
(mknod)3.25 E F2(system call:)3.25 E/F4 10/Courier@0 SF
(if \(mknod\("/tmp/namedpipe",S_IFIFO|0600,0\)<0\))33.336 662.982 Q({)
33.336 674.982 Q
(perror\("unable to create named pipe /tmp/namedpipe"\);)90.936 686.982
Q(})33.336 698.982 Q 6($.)33.336 722.982 S(/a.out)-6 E 6($l)33.336
734.982 S 6(s-)-6 G 6(l/)-6 G(tmp/namedpipe)-6 E 0 Cg EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 4/pg 14)71.748 E(\2512015 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 10/Courier@0 SF 18(prw------- 1)33.336 117 R 30(hak root)6 F
6(0S)72 G(ep 25 23:12 /tmp/namedpipe)-6 E/F2 13/Times-Roman@0 SF 1.612
(In the e)33.336 138 R 1.612(xample abo)-.195 F -.195(ve)-.195 G 4.862
(,t).195 G 1.612
(he leading "p" in the ls output identi\214es the created inode as a)
-4.862 F(named pipe \(IFIFO\).)33.336 153 Q
(Note that the permissions mode is bitwise-OR')6.5 E(d.)-.65 E 2.326
(The FIFO inode can also be created from the command prompt using the)
33.336 174 R/F3 13/Courier@0 SF(mknod)5.576 E F2(or)5.576 E F3(mkfifo)
33.336 189 Q F2(command.)3.25 E .409
(Semantics of named pipes are slightly dif)33.336 210 R .41
(ferent from anon)-.325 F .41(ymous pipes.)-.195 F .41(Since the named)
6.91 F 2.644(pipe is opened with)33.336 225 R F3(open)5.894 E F2 5.894
(,i)C 5.894(tc)-5.894 G 2.644(an be opened read-only)-5.894 F 5.894(,w)
-.845 G 2.644(rite-only or read/write \(i.e.)-5.894 F F3(O_RDONLY)33.336
240 Q F2(,)A F3(O_WRONLY)3.305 E F2(,)A F3(O_RDWR)3.305 E F2 3.305
(\). There)B .055(can be more than one opening of the pipe too)3.305 F
1.397(\(i.e. multiple)33.336 255 R F3 1.397(struct file)4.647 F F2 1.397
(in the k)4.647 F 4.647(ernel\). When)-.13 F 4.647(an)4.647 G 1.397
(amed pipe is opened read-only)-4.647 F(,)-.845 E 1.764(the open system\
 call blocks until there is at least one instance of the same pipe bein\
g)33.336 270 R 3.607(opened for writing \(or read/write\).)33.336 285 R
(Lik)10.107 E -.325(ew)-.13 G 3.607(ise, a write-only open blocks w).325
F 3.606(aiting for)-.13 F 3.25(readers. A)33.336 300 R
(read/write open al)3.25 E -.13(wa)-.13 G(ys succeeds immediately).13 E
(.)-.845 E F3(read)33.336 321 Q F2 1.476
(from a named pipe returns whate)4.725 F -.195(ve)-.325 G 4.726(rd).195
G 1.476(ata are currently in the FIFO, or blocks if)-4.726 F .525
(there are no data, just lik)33.336 336 R 3.775(ea)-.13 G(non)-3.775 E
.525(ymous pipes.)-.195 F .525
(If there are no writers, read returns 0 \(after)7.025 F 1.229
(returning an)33.336 351 R 4.479(yp)-.195 G 1.229(ending data\).)-4.479
F 1.229(But unlik)7.729 F 4.48(ea)-.13 G 4.48(na)-4.48 G(non)-4.48 E
1.23(ymous pipe, this EOF-lik)-.195 F 4.48(ec)-.13 G 1.23(ondition is)
-4.48 F .565(not permanent.)33.336 366 R .565
(If another writer appears, future reads may return additional data.)
7.065 F .565(In the)7.065 F .819(meantime, all reads w)33.336 381 R .82
(ould return 0.)-.13 F .82
(Because this condition results in a "spin loop," it is)7.32 F .57(bett\
er practice to close the read side of the named pipe upon an EOF condit\
ion, and then)33.336 396 R(re-open it.)33.336 411 Q
(The open will then block until another writer comes along.)6.5 E(Lik)
33.336 432 Q -.325(ew)-.13 G 2.992
(ise, a write to a named pipe with no readers results in either a).325 F
F3(SIGPIPE)6.242 E F2(or)6.242 E F3(EPIPE)33.336 447 Q F2 3.774(,j)C
.524(ust lik)-3.774 F 3.774(ea)-.13 G(non)-3.774 E .524(ymous pipes.)
-.195 F .523(Furthermore, the same kind of non-blocking options)7.024 F
(can be applied.)33.336 462 Q 1.474
(Named pipes can be used as a means of inter)33.336 483 R 1.475
(-process communication among unrelated)-.26 F 2.037
(processes on the same local system.)33.336 498 R 2.036
(On some systems, named pipes are synon)8.537 F(ymous)-.195 E
(with "UNIX-domain sock)33.336 513 Q(ets", which will be co)-.13 E -.195
(ve)-.195 G(red in a later unit.).195 E 0 Cg EP
%%Trailer
end
%%EOF
